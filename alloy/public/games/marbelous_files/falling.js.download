pc.script.create('falling', function (app) {
    // Creates a new Falling instance
    var Falling = function (entity) {
        this.entity = entity;
    };

    var dareset = false;

    Falling.prototype = {
        // Called once after all resources are loaded and before the first update
        initialize: function () {
            this.origPos = this.entity.getPosition();
            this.really = false;
            this.wait = 0.75;
            this.resetWait = 0.5;
            this.entity.collision.on('collisionstart',this.start,this);
            document.addEventListener('myEvent', this.Reset, this);
        },

        start: function(){
            this.really = true;
            dareset = false;
        },
        
        Reset: function(){
            dareset = true;
        },
        
        execute: function(){
            this.entity.setPosition(this.origPos.x,this.origPos.y,this.origPos.z);
            this.entity.rigidbody.syncEntityToBody();
            this.entity.rigidbody.type = 'static';
            this.really = false;
            this.wait = 0.75;
        },
        // Called every frame, dt is time in seconds since last update
        update: function (dt) {
            if(this.really === true){
                this.wait -= dt;
                if(this.wait <= dt){
                    this.entity.rigidbody.type = 'dynamic';
                }
            }
            if(dareset === true){
                this.resetWait -= dt;
                this.execute();
            }
        }
    };

    return Falling;
});